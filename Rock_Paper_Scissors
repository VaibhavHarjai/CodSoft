import random

while True:
    print("~~~~~~~Welcome to Rock, Paper, Scissors~~~~~~~")

    user_score = 0
    computer_score = 0
    ties = 0

    name = input("Enter Your Name Here: ")
    print("""
    Winning Rules: 
    1. Paper vs Rock --> Paper
    2. Rock vs Scissors --> Rock
    3. Scissors vs Paper --> Scissors """)
    
    while True:
        print()
        print("""Choices are:
        1. Rock
        2. Paper
        3. Scissors""")
        print()
        choice = int(input("Enter Your Choice From 1-3: "))
        print()
        
        while choice > 3 or choice < 1:
            choice = int(input("Enter Valid Input: "))

        if choice == 1:
            user_choice = "Rock"
        elif choice == 2:
            user_choice = "Paper"
        else:
            user_choice = "Scissors"

        print("The User's Choice is", user_choice)
        print("Now it is Computer's turn...")

        computer = random.randint(1, 3)
        if computer == 1:
            comp_choice = "Rock"
        elif computer == 2:
            comp_choice = "Paper"
        else:
            comp_choice = "Scissors"

        print("The Computer's Choice is", comp_choice)

        if user_choice == comp_choice:
            print("It's a Tie!")
            result = "Tie"
        elif (user_choice == "Paper" and comp_choice == "Rock") or \
             (user_choice == "Rock" and comp_choice == "Scissors") or \
             (user_choice == "Scissors" and comp_choice == "Paper"):
            print(f"{user_choice} wins!")
            result = user_choice
        else:
            print(f"{comp_choice} wins!")
            result = comp_choice

        if result == "Tie":
            ties += 1
        elif result == user_choice:
            print("User wins this round!")
            user_score += 1
        else:
            print("Computer wins this round!")
            computer_score += 1

        print(f"\nScores: \n{name}'s Score: {user_score} \nComputer's Score: {computer_score} \nTies: {ties}")

        repeat = input("Do you want to play again? (Yes/No): ").strip().lower()
        if repeat == "no":
            break

    print("Game Over!")
    print("Thanks for Playing!!")
    break
